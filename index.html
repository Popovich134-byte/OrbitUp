<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>OrbitUp | Pure Neon</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { background-color: #000; color: #39FF14; font-family: 'sans-serif'; overflow-x: hidden; }
        .neon-border { border: 1px solid #39FF14; box-shadow: 0 0 15px rgba(57,255,20,0.3); }
        .glass { background: rgba(255, 255, 255, 0.05); backdrop-filter: blur(10px); }
        .page { display: none; }
        .page.active { display: block; animation: fadeIn 0.3s; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        #crash-canvas { width: 100%; height: 200px; background: #050505; border-radius: 20px; }
    </style>
</head>
<body class="p-4">

    <div id="splash" class="fixed inset-0 z-50 bg-black flex flex-col items-center justify-center">
        <h1 class="text-4xl font-black italic tracking-tighter mb-2">ORBIT UP</h1>
        <div class="w-12 h-1 bg-[#39FF14] animate-pulse"></div>
    </div>

    <div id="lang-page" class="page fixed inset-0 bg-black flex flex-col items-center justify-center p-6">
        <h2 class="text-xl mb-8 uppercase font-bold">–í—ã–±–µ—Ä–∏—Ç–µ —è–∑—ã–∫</h2>
        <button onclick="initApp('ru')" class="w-full glass neon-border p-5 rounded-2xl mb-4 font-bold">–†–£–°–°–ö–ò–ô</button>
        <button onclick="initApp('en')" class="w-full glass neon-border p-5 rounded-2xl font-bold">ENGLISH</button>
    </div>

    <div id="main-app" class="page">
        <div class="flex justify-between items-center mb-6">
            <div class="flex flex-col">
                <span id="user-name" class="font-bold text-white text-lg">GUEST</span>
                <span class="text-[10px] opacity-50 uppercase tracking-widest">Premium Member</span>
            </div>
            <div class="glass neon-border px-4 py-2 rounded-full flex items-center gap-2">
                <span>‚≠ê</span>
                <span id="balance-display" class="font-black">1250</span>
            </div>
        </div>

        <div class="glass neon-border rounded-3xl p-5 mb-6">
            <div class="flex justify-between mb-4">
                <span class="text-xs font-bold opacity-50">CRASH GAME</span>
                <span id="multiplier" class="text-3xl font-black">1.00x</span>
            </div>
            <canvas id="crash-canvas"></canvas>
            
            <div id="crash-controls" class="mt-4 flex gap-2">
                <input id="bet-amount" type="number" placeholder="–°—É–º–º–∞..." class="w-1/2 bg-white/10 rounded-xl px-4 text-white outline-none focus:border-[#39FF14] border border-transparent">
                <button id="btn-bet" onclick="placeBet()" class="w-1/2 bg-[#39FF14] text-black font-bold py-3 rounded-xl uppercase">–°—Ç–∞–≤–∫–∞</button>
                <button id="btn-cashout" onclick="cashOut()" class="hidden w-1/2 bg-white text-black font-bold py-3 rounded-xl uppercase">–ó–∞–±—Ä–∞—Ç—å</button>
            </div>
        </div>

        <div class="flex gap-2 mb-6 overflow-x-auto pb-2">
            <button onclick="switchTab('gifts')" class="glass px-6 py-2 rounded-full text-xs font-bold whitespace-nowrap">üéÅ –ü–û–î–ê–†–ö–ò</button>
            <button onclick="switchTab('trade')" class="glass px-6 py-2 rounded-full text-xs font-bold whitespace-nowrap">üîÑ –¢–†–ï–ô–î</button>
            <button onclick="switchTab('wallet')" class="glass px-6 py-2 rounded-full text-xs font-bold whitespace-nowrap">üí≥ –ö–û–®–ï–õ–ï–ö</button>
        </div>

        <div id="gifts-section" class="tab-content">
            <div class="grid grid-cols-2 gap-4">
                <div class="glass p-4 rounded-2xl text-center">
                    <div class="text-4xl mb-2">üíé</div>
                    <div class="text-[10px] font-bold">NFT GIFT #1</div>
                    <div class="text-[#39FF14] text-sm mb-2">5.0 TON</div>
                    <button onclick="requestBuy('NFT Gift #1', 5)" class="w-full bg-white/10 py-2 rounded-lg text-[9px] font-bold">–ö–£–ü–ò–¢–¨</button>
                </div>
                <div class="glass p-4 rounded-2xl text-center">
                    <div class="text-4xl mb-2">üî•</div>
                    <div class="text-[10px] font-bold">NFT GIFT #2</div>
                    <div class="text-[#39FF14] text-sm mb-2">8.2 TON</div>
                    <button onclick="requestBuy('NFT Gift #2', 8.2)" class="w-full bg-white/10 py-2 rounded-lg text-[9px] font-bold">–ö–£–ü–ò–¢–¨</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        let balance = 1250;
        let currentBet = 0;
        let isGameRunning = false;
        let multiplier = 1.0;

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        setTimeout(() => {
            document.getElementById('splash').style.opacity = '0';
            setTimeout(() => {
                document.getElementById('splash').remove();
                document.getElementById('lang-page').classList.add('active');
            }, 500);
        }, 3000);

        function initApp(lang) {
            document.getElementById('lang-page').classList.remove('active');
            document.getElementById('main-app').classList.add('active');
            if(tg.initDataUnsafe?.user) {
                document.getElementById('user-name').innerText = tg.initDataUnsafe.user.first_name.toUpperCase();
            }
            startCrashEngine();
        }

        // –õ–æ–≥–∏–∫–∞ –ö—Ä–∞—à–∞
        function placeBet() {
            const amt = parseInt(document.getElementById('bet-amount').value);
            if(amt > 0 && amt <= balance) {
                balance -= amt;
                currentBet = amt;
                updateBalance();
                document.getElementById('btn-bet').classList.add('hidden');
                document.getElementById('btn-cashout').classList.remove('hidden');
                tg.HapticFeedback.impactOccurred('medium');
            }
        }

        function cashOut() {
            if(currentBet > 0) {
                const win = currentBet * multiplier;
                balance += win;
                updateBalance();
                resetGame();
                tg.HapticFeedback.notificationOccurred('success');
                alert(`–í—ã –≤—ã–∏–≥—Ä–∞–ª–∏: ${win.toFixed(2)} ‚≠ê`);
            }
        }

        function resetGame() {
            currentBet = 0;
            document.getElementById('btn-bet').classList.remove('hidden');
            document.getElementById('btn-cashout').classList.add('hidden');
        }

        function updateBalance() {
            document.getElementById('balance-display').innerText = Math.floor(balance);
        }

        function startCrashEngine() {
            const canvas = document.getElementById('crash-canvas');
            const ctx = canvas.getContext('2d');
            let pts = [];

            function animate() {
                ctx.clearRect(0,0, canvas.width, canvas.height);
                multiplier += 0.007;
                
                // –†–∞–Ω–¥–æ–º–Ω—ã–π –∫—Ä–∞—à
                if(Math.random() < 0.003) {
                    multiplier = 1.0;
                    pts = [];
                    if(currentBet > 0) {
                        tg.HapticFeedback.notificationOccurred('error');
                        resetGame();
                    }
                }

                pts.push(multiplier);
                if(pts.length > 60) pts.shift();

                ctx.strokeStyle = '#39FF14';
                ctx.lineWidth = 4;
                ctx.beginPath();
                pts.forEach((p, i) => {
                    ctx.lineTo((i/60)*canvas.width, canvas.height - (p*15));
                });
                ctx.stroke();

                document.getElementById('multiplier').innerText = multiplier.toFixed(2) + 'x';
                requestAnimationFrame(animate);
            }
            animate();
        }

        // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä—É—á–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ (–æ—Ç–ø—Ä–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö —Ç–µ–±–µ)
        function requestBuy(item, price) {
            tg.showConfirm(`–ö—É–ø–∏—Ç—å ${item} –∑–∞ ${price} TON?`, (ok) => {
                if(ok) {
                    tg.sendData(JSON.stringify({action: 'buy', item: item, price: price}));
                    alert("–ó–∞–ø—Ä–æ—Å –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –∞–¥–º–∏–Ω—É!");
                }
            });
        }
    </script>
</body>
</html>
