<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Neon Gaming Pro v2</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Inter:wght@400;600;800&display=swap');
        
        :root { --neon: #39FF14; --ton: #0098EA; --bg: #050505; --panel: #111; }

        body { background: var(--bg); color: white; font-family: 'Inter', sans-serif; overflow: hidden; height: 100vh; margin: 0; user-select: none; }
        
        .font-tech { font-family: 'Orbitron', sans-serif; }
        .text-neon { color: var(--neon); text-shadow: 0 0 10px rgba(57, 255, 20, 0.4); }
        .text-ton { color: var(--ton); text-shadow: 0 0 10px rgba(0, 152, 234, 0.4); }

        .glass-panel { 
            background: rgba(20, 20, 20, 0.7); 
            backdrop-filter: blur(20px); 
            border: 1px solid rgba(255, 255, 255, 0.08); 
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.5);
        }

        /* –ö–Ω–æ–ø–∫–∏ */
        .neon-btn { background: var(--neon); color: black; box-shadow: 0 0 15px rgba(57, 255, 20, 0.3); }
        .ton-btn { background: var(--ton); color: white; box-shadow: 0 0 15px rgba(0, 152, 234, 0.3); }
        .action-btn { font-weight: 800; border-radius: 16px; transition: 0.15s; }
        .action-btn:active { transform: scale(0.96); }

        /* –ù–∞–≤–∏–≥–∞—Ü–∏—è */
        .nav-dock {
            position: fixed; bottom: 24px; left: 50%; transform: translateX(-50%);
            width: 90%; max-width: 380px;
            background: rgba(10, 10, 10, 0.9); backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 24px;
            display: flex; justify-content: space-around; padding: 12px 0; z-index: 50;
        }
        .nav-item { color: #555; transition: 0.3s; padding: 8px; border-radius: 12px; }
        .nav-item.active { color: white; background: rgba(255,255,255,0.05); }
        .nav-item.active svg { filter: drop-shadow(0 0 5px white); }

        /* –í–∫–ª–∞–¥–∫–∏ */
        .tab-content { display: none; height: calc(100vh - 180px); overflow-y: auto; padding: 20px; padding-bottom: 100px; }
        .tab-content.active { display: block; animation: fadeUp 0.3s ease; }
        @keyframes fadeUp { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* –†—É–ª–µ—Ç–∫–∞ */
        .roulette-wrapper { position: relative; width: 100%; height: 120px; background: #000; border-radius: 20px; overflow: hidden; border: 1px solid #333; }
        .roulette-track { display: flex; position: absolute; height: 100%; align-items: center; left: 0; }
        .roulette-item { min-width: 90px; height: 100px; margin: 0 4px; background: #151515; border-radius: 14px; border: 1px solid #222; display: flex; flex-direction: column; align-items: center; justify-content: center; }
        .roulette-marker { position: absolute; left: 50%; top: 0; bottom: 0; width: 4px; background: white; z-index: 10; transform: translateX(-50%); box-shadow: 0 0 10px white; }

        /* –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å –≤–∞–ª—é—Ç */
        .currency-switch { background: #111; border-radius: 12px; padding: 4px; display: flex; gap: 4px; border: 1px solid #333; }
        .curr-opt { flex: 1; text-align: center; font-size: 10px; font-weight: bold; padding: 6px; border-radius: 8px; transition: 0.2s; color: #666; }
        .curr-opt.active-stars { background: rgba(57, 255, 20, 0.2); color: var(--neon); border: 1px solid var(--neon); }
        .curr-opt.active-ton { background: rgba(0, 152, 234, 0.2); color: var(--ton); border: 1px solid var(--ton); }
    </style>
</head>
<body>

    <header class="pt-4 px-6 flex justify-between items-start z-20 relative">
        <div onclick="openWallet()" class="glass-panel rounded-2xl p-2 pr-4 flex items-center gap-3 cursor-pointer active:scale-95 transition">
            <div class="w-10 h-10 rounded-xl bg-[#1a1a1a] flex items-center justify-center border border-gray-700" id="walletIcon">
                ‚≠ê
            </div>
            <div>
                <p class="text-[9px] text-gray-400 font-bold uppercase tracking-wider">–ë–∞–ª–∞–Ω—Å</p>
                <div class="flex items-center gap-1">
                    <span class="font-tech font-bold text-lg" id="balanceDisplay">1000</span>
                    <span class="text-xs font-bold" id="currencySymbol">STARS</span>
                </div>
            </div>
        </div>

        <div class="flex flex-col gap-2">
            <div class="currency-switch w-32">
                <button onclick="setCurrency('stars')" id="btn-stars" class="curr-opt active-stars">STARS</button>
                <button onclick="setCurrency('ton')" id="btn-ton" class="curr-opt">TON</button>
            </div>
        </div>
    </header>

    <main>
        <section id="page-crash" class="tab-content active">
            <div class="relative w-full h-72 bg-[#080808] rounded-[32px] border border-gray-800 mb-6 overflow-hidden flex flex-col items-center justify-center shadow-2xl">
                <div class="absolute inset-0" style="background-image: radial-gradient(#222 1px, transparent 1px); background-size: 24px 24px; opacity: 0.5;"></div>
                <div id="rocket" class="absolute text-5xl transition-opacity duration-200" style="bottom: 10%; left: 10%; opacity: 0;">üöÄ</div>
                
                <div id="mult-display" class="relative z-10 text-6xl font-black font-tech text-white">1.00x</div>
                <div id="game-status" class="relative z-10 text-[10px] text-gray-500 font-bold uppercase tracking-[0.2em] mt-2">–û–∂–∏–¥–∞–Ω–∏–µ...</div>
                
                <div id="timer-bar" class="absolute bottom-0 left-0 h-1.5 bg-white w-0 shadow-[0_0_10px_white]"></div>
            </div>

            <div class="glass-panel rounded-[24px] p-5">
                <div class="flex justify-between text-[10px] text-gray-500 font-bold uppercase mb-2">
                    <span>–°—É–º–º–∞ —Å—Ç–∞–≤–∫–∏</span>
                    <span id="min-bet-label">Min: 25 Stars</span>
                </div>
                <div class="flex gap-3">
                    <div class="relative flex-grow">
                        <input id="betInput" type="number" class="w-full bg-[#050505] border border-gray-700 rounded-2xl p-4 text-center text-xl font-bold text-white outline-none focus:border-white transition">
                    </div>
                    <button onclick="handleBetClick()" id="crashBtn" class="w-1/2 action-btn neon-btn uppercase text-sm tracking-wider">–°—Ç–∞–≤–∫–∞</button>
                </div>
            </div>
        </section>

        <section id="page-cases" class="tab-content">
            <div id="cases-list">
                <h2 class="text-center font-tech text-2xl font-black uppercase text-white mb-6">Mystery <span class="text-neon">Cases</span></h2>
                
                <div class="grid gap-4">
                    <div onclick="openCaseView(0)" class="glass-panel p-4 rounded-[28px] flex items-center gap-4 cursor-pointer active:scale-95 transition group border border-gray-800 hover:border-[#39FF14]">
                        <div class="w-16 h-16 rounded-2xl bg-[#39FF14]/10 flex items-center justify-center text-3xl group-hover:scale-110 transition">üì¶</div>
                        <div class="flex-grow">
                            <h3 class="font-bold text-lg">–ù–æ–≤–∏—á–æ–∫</h3>
                            <p class="text-xs text-gray-500">–ü—Ä–∏–∑—ã –¥–æ 100 Stars</p>
                        </div>
                        <div class="text-right">
                            <p class="font-tech font-bold text-[#39FF14]">50 ‚≠ê</p>
                            <span class="text-[9px] text-gray-600 uppercase font-bold">–û—Ç–∫—Ä—ã—Ç—å</span>
                        </div>
                    </div>

                    <div onclick="openCaseView(1)" class="glass-panel p-4 rounded-[28px] flex items-center gap-4 cursor-pointer active:scale-95 transition group border border-gray-800 hover:border-[#0098EA]">
                        <div class="w-16 h-16 rounded-2xl bg-[#0098EA]/10 flex items-center justify-center text-3xl group-hover:scale-110 transition">üíº</div>
                        <div class="flex-grow">
                            <h3 class="font-bold text-lg">–¢—Ä–µ–π–¥–µ—Ä</h3>
                            <p class="text-xs text-gray-500">–ü—Ä–∏–∑—ã –≤ TON</p>
                        </div>
                        <div class="text-right">
                            <p class="font-tech font-bold text-[#0098EA]">0.5 TON</p>
                            <span class="text-[9px] text-gray-600 uppercase font-bold">–û—Ç–∫—Ä—ã—Ç—å</span>
                        </div>
                    </div>

                    <div onclick="openCaseView(2)" class="glass-panel p-4 rounded-[28px] flex items-center gap-4 cursor-pointer active:scale-95 transition group border border-gray-800 hover:border-yellow-500">
                        <div class="w-16 h-16 rounded-2xl bg-yellow-500/10 flex items-center justify-center text-3xl group-hover:scale-110 transition">üëë</div>
                        <div class="flex-grow">
                            <h3 class="font-bold text-lg text-yellow-500">–ú–∞–≥–Ω–∞—Ç</h3>
                            <p class="text-xs text-gray-500">–®–∞–Ω—Å –Ω–∞ –î–∂–µ–∫–ø–æ—Ç</p>
                        </div>
                        <div class="text-right">
                            <p class="font-tech font-bold text-yellow-500">500 ‚≠ê</p>
                            <span class="text-[9px] text-gray-600 uppercase font-bold">–û—Ç–∫—Ä—ã—Ç—å</span>
                        </div>
                    </div>
                </div>
            </div>

            <div id="case-roulette-view" class="hidden h-full flex flex-col">
                <button onclick="closeCaseView()" class="mb-4 text-xs font-bold text-gray-500 flex items-center gap-1 hover:text-white">‚Üê –ù–ê–ó–ê–î –ö –°–ü–ò–°–ö–£</button>
                
                <div class="flex-grow flex flex-col justify-center">
                    <h2 id="active-case-name" class="text-center text-2xl font-black font-tech mb-6 uppercase">Case Name</h2>
                    
                    <div class="roulette-wrapper mb-8">
                        <div class="roulette-marker"></div>
                        <div id="rouletteTrack" class="roulette-track"></div>
                    </div>

                    <div class="text-center">
                        <button onclick="spinRoulette()" id="spinBtn" class="w-full py-5 rounded-2xl font-black uppercase text-sm tracking-widest shadow-xl transition transform active:scale-95"></button>
                    </div>
                </div>
            </div>
        </section>

        <section id="page-profile" class="tab-content">
            <div class="glass-panel p-6 rounded-[32px] text-center mt-6">
                <div class="w-24 h-24 mx-auto bg-gradient-to-br from-gray-800 to-black rounded-full flex items-center justify-center text-4xl mb-4 border-2 border-gray-700">ü¶ä</div>
                <h2 class="text-xl font-bold">VIP Player</h2>
                <p class="text-xs text-gray-500 mt-1 uppercase">ID: 883211</p>
                
                <div class="grid grid-cols-2 gap-3 mt-6">
                    <div class="bg-black/40 p-3 rounded-xl">
                        <p class="text-[9px] text-gray-500 uppercase font-bold">–í—Å–µ–≥–æ Stars</p>
                        <p class="font-tech text-[#39FF14]" id="prof-stars">0</p>
                    </div>
                    <div class="bg-black/40 p-3 rounded-xl">
                        <p class="text-[9px] text-gray-500 uppercase font-bold">–í—Å–µ–≥–æ TON</p>
                        <p class="font-tech text-[#0098EA]" id="prof-ton">0</p>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <nav class="nav-dock">
        <button onclick="nav('crash')" id="nav-crash" class="nav-item active">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.48-.56.93-1.23 1.35-2h4.65c.96 0 1.88.38 2.59 1.06l.32.32a.75.75 0 0 0 1.06 0l2.12-2.12a.75.75 0 0 0 0-1.06l-.32-.32a3.68 3.68 0 0 0-1.06-2.59V8.15c.77-.42 1.44-.87 2-1.35 1.5-1.26 2-5 2-5s-3.74.5-5 2c-.48.56-.93 1.23-1.35 2H9.85c-.96 0-1.88-.38-2.59-1.06l-.32-.32a.75.75 0 0 0-1.06 0L3.76 6.54a.75.75 0 0 0 0 1.06l.32.32c.68.71 1.06 1.63 1.06 2.59v4.65c-.42.77-.87 1.44-1.35 2z"/></svg>
        </button>
        <button onclick="nav('cases')" id="nav-cases" class="nav-item">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"></path><polyline points="3.27 6.96 12 12.01 20.73 6.96"></polyline><line x1="12" y1="22.08" x2="12" y2="12"></line></svg>
        </button>
        <button onclick="nav('profile')" id="nav-profile" class="nav-item">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path><circle cx="12" cy="7" r="4"></circle></svg>
        </button>
    </nav>

    <div id="wallet-modal" class="fixed inset-0 z-[100] bg-black/80 backdrop-blur-sm hidden flex flex-col justify-end transition-all duration-300 opacity-0 pointer-events-none">
        <div class="bg-[#111] rounded-t-[32px] p-6 border-t border-gray-800 shadow-2xl transform translate-y-full transition-transform duration-300" id="wallet-content">
            <div class="w-12 h-1 bg-gray-700 mx-auto mb-6 rounded-full cursor-pointer" onclick="closeWallet()"></div>
            <h3 class="text-center font-bold text-white mb-6 uppercase tracking-widest">–ö–∞—Å—Å–∞ (<span id="wallet-currency-name">STARS</span>)</h3>
            
            <input id="wallet-input" type="number" placeholder="–°—É–º–º–∞" class="w-full bg-black border border-gray-800 p-4 rounded-xl text-center text-white font-bold text-xl outline-none mb-4">
            
            <div class="grid grid-cols-2 gap-4">
                <button onclick="walletAction(1)" class="py-4 bg-[#39FF14] text-black font-black rounded-xl uppercase">–ü–æ–ø–æ–ª–Ω–∏—Ç—å</button>
                <button onclick="walletAction(-1)" class="py-4 bg-gray-800 text-white font-bold rounded-xl uppercase">–í—ã–≤–µ—Å—Ç–∏</button>
            </div>
        </div>
    </div>

    <script>
        // --- –î–ê–ù–ù–´–ï –ò –°–û–°–¢–û–Ø–ù–ò–ï ---
        let balances = { stars: 1000.0, ton: 5.0 };
        let currentCurrency = 'stars'; // 'stars' or 'ton'
        let game = { state: 'waiting', mult: 1.0, crashAt: 0, myBet: 0, cashedOut: false };

        const casesData = [
            { id: 0, name: "–ù–æ–≤–∏—á–æ–∫", price: 50, curr: 'stars', color: '#39FF14', btnClass: 'neon-btn', prizes: [10, 25, 50, 75, 100] },
            { id: 1, name: "–¢—Ä–µ–π–¥–µ—Ä", price: 0.5, curr: 'ton', color: '#0098EA', btnClass: 'ton-btn', prizes: [0.1, 0.3, 0.5, 0.8, 1.5] },
            { id: 2, name: "–ú–∞–≥–Ω–∞—Ç", price: 500, curr: 'stars', color: '#FFD700', btnClass: 'bg-yellow-500 text-black', prizes: [100, 250, 500, 1000, 5000] }
        ];
        let activeCase = null;

        // --- –í–ê–õ–Æ–¢–ê –ò UI ---
        function setCurrency(c) {
            currentCurrency = c;
            
            // –°—Ç–∏–ª–∏ –∫–Ω–æ–ø–æ–∫
            document.getElementById('btn-stars').className = c==='stars' ? 'curr-opt active-stars' : 'curr-opt';
            document.getElementById('btn-ton').className = c==='ton' ? 'curr-opt active-ton' : 'curr-opt';
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∫–æ–Ω–æ–∫ –∏ —Ü–≤–µ—Ç–æ–≤ –≤ —à–∞–ø–∫–µ
            const walletIcon = document.getElementById('walletIcon');
            const crashBtn = document.getElementById('crashBtn');
            const timerBar = document.getElementById('timer-bar');

            if(c === 'stars') {
                walletIcon.innerText = '‚≠ê';
                walletIcon.style.borderColor = '#333';
                document.getElementById('currencySymbol').innerText = 'STARS';
                document.getElementById('currencySymbol').style.color = 'white';
                document.getElementById('min-bet-label').innerText = 'Min: 25 Stars';
                document.getElementById('betInput').value = '25';
                crashBtn.className = 'w-1/2 action-btn neon-btn uppercase text-sm tracking-wider';
                timerBar.style.backgroundColor = '#39FF14';
                timerBar.style.boxShadow = '0 0 10px #39FF14';
            } else {
                walletIcon.innerText = 'üíé';
                walletIcon.style.borderColor = '#0098EA';
                document.getElementById('currencySymbol').innerText = 'TON';
                document.getElementById('currencySymbol').style.color = '#0098EA';
                document.getElementById('min-bet-label').innerText = 'Min: 0.1 TON';
                document.getElementById('betInput').value = '0.1';
                crashBtn.className = 'w-1/2 action-btn ton-btn uppercase text-sm tracking-wider';
                timerBar.style.backgroundColor = '#0098EA';
                timerBar.style.boxShadow = '0 0 10px #0098EA';
            }
            updateBalance();
        }

        function updateBalance() {
            let val = balances[currentCurrency];
            document.getElementById('balanceDisplay').innerText = val.toFixed(currentCurrency==='ton'? 2 : 0);
            document.getElementById('prof-stars').innerText = balances.stars.toFixed(0);
            document.getElementById('prof-ton').innerText = balances.ton.toFixed(2);
        }

        // --- CRASH LOGIC (–ñ–ê–î–ù–´–ô –ê–õ–ì–û–†–ò–¢–ú) ---
        function runCrashCycle() {
            game.state = 'waiting'; game.cashedOut = false; game.mult = 1.0;
            
            const bar = document.getElementById('timer-bar');
            bar.style.width = '100%'; bar.style.transition = 'width 5s linear';
            
            document.getElementById('game-status').innerText = '–ó–ê–ì–†–£–ó–ö–ê –î–í–ò–ì–ê–¢–ï–õ–ï–ô';
            document.getElementById('rocket').style.opacity = '0';
            document.getElementById('mult-display').className = 'relative z-10 text-6xl font-black font-tech text-white';
            
            updateCrashBtn();

            setTimeout(() => {
                bar.style.transition = 'none'; bar.style.width = '0%';
                launchRocket();
            }, 5000);
        }

        function launchRocket() {
            game.state = 'flying';
            document.getElementById('game-status').innerText = '–ü–û–õ–ï–¢ –ù–û–†–ú–ê–õ–¨–ù–´–ô';
            document.getElementById('rocket').style.opacity = '1';

            // –ñ–ê–î–ù–´–ô –ê–õ–ì–û–†–ò–¢–ú
            // 45% –∫—Ä–∞—à –ø–æ—á—Ç–∏ —Å—Ä–∞–∑—É (1.0x - 1.4x) - –ó–∞–±–∏—Ä–∞–µ–º –¥–µ–Ω—å–≥–∏
            // 35% –∫—Ä–∞—à —Å—Ä–µ–¥–Ω–∏–π (1.4x - 2.0x) - –î–∞–µ–º –Ω–µ–º–Ω–æ–≥–æ –≤—ã–∏–≥—Ä–∞—Ç—å
            // 15% –∫—Ä–∞—à —Ö–æ—Ä–æ—à–∏–π (2.0x - 4.0x)
            // 5%  –¥–∂–µ–∫–ø–æ—Ç (> 4.0x)
            let r = Math.random();
            if (r < 0.45) game.crashAt = 1.0 + Math.random() * 0.4;
            else if (r < 0.8) game.crashAt = 1.4 + Math.random() * 0.6;
            else if (r < 0.95) game.crashAt = 2.0 + Math.random() * 2.0;
            else game.crashAt = 4.0 + Math.random() * 10;

            const interval = setInterval(() => {
                if (game.state !== 'flying') { clearInterval(interval); return; }
                
                game.mult += 0.015;
                document.getElementById('mult-display').innerText = game.mult.toFixed(2) + 'x';

                // –í–∏–∑—É–∞–ª —Ä–∞–∫–µ—Ç—ã
                let p = Math.min(80, (game.mult - 1) * 20);
                document.getElementById('rocket').style.bottom = (10 + p/2) + '%';
                document.getElementById('rocket').style.left = (10 + p) + '%';

                if (game.mult >= game.crashAt) {
                    game.state = 'crashed';
                    document.getElementById('mult-display').innerText = 'CRASH';
                    document.getElementById('mult-display').className = 'relative z-10 text-6xl font-black font-tech text-red-500';
                    document.getElementById('rocket').style.opacity = '0';
                    document.getElementById('game-status').innerText = '–í–ó–†–´–í';
                    
                    if (game.myBet > 0) {
                        // –ò–≥—Ä–æ–∫ –ø—Ä–æ–∏–≥—Ä–∞–ª —Å—Ç–∞–≤–∫—É
                    }
                    game.myBet = 0;
                    updateCrashBtn();
                    setTimeout(runCrashCycle, 3000);
                    clearInterval(interval);
                }
            }, 50);
        }

        function handleBetClick() {
            if (game.state === 'waiting' && game.myBet === 0) {
                // –ü–†–û–í–ï–†–ö–ê –ú–ò–ù–ò–ú–ê–õ–¨–ù–û–ô –°–¢–ê–í–ö–ò
                let amount = parseFloat(document.getElementById('betInput').value);
                let min = currentCurrency === 'stars' ? 25 : 0.1;
                
                if (amount < min) return alert(`–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—Ç–∞–≤–∫–∞: ${min} ${currentCurrency.toUpperCase()}`);
                if (amount > balances[currentCurrency]) return alert('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤!');

                balances[currentCurrency] -= amount;
                game.myBet = amount;
                updateBalance();
                updateCrashBtn();
            } else if (game.state === 'flying' && game.myBet > 0 && !game.cashedOut) {
                // Cash Out
                let win = game.myBet * game.mult;
                balances[currentCurrency] += win;
                game.cashedOut = true;
                alert(`–í—ã–∏–≥—Ä—ã—à: ${win.toFixed(2)}`);
                updateBalance();
                updateCrashBtn();
            }
        }

        function updateCrashBtn() {
            const btn = document.getElementById('crashBtn');
            if (game.state === 'waiting') {
                btn.innerText = game.myBet > 0 ? '–ñ–î–ï–ú –°–¢–ê–†–¢...' : '–°–¢–ê–í–ö–ê';
                btn.disabled = game.myBet > 0;
                btn.style.opacity = game.myBet > 0 ? 0.5 : 1;
            } else if (game.state === 'flying') {
                if (game.myBet > 0 && !game.cashedOut) {
                    btn.innerText = `–ó–ê–ë–†–ê–¢–¨ ${(game.myBet * game.mult).toFixed(1)}`;
                    btn.disabled = false;
                    btn.style.opacity = 1;
                    btn.className = 'w-1/2 action-btn bg-white text-black uppercase text-sm tracking-wider shadow-[0_0_20px_white]';
                } else {
                    btn.innerText = '–ü–û–õ–ï–¢...';
                    btn.disabled = true;
                    btn.style.opacity = 0.5;
                    btn.className = 'w-1/2 action-btn bg-gray-800 text-white uppercase text-sm';
                }
            } else {
                btn.innerText = '–ö–†–ê–®';
                btn.className = 'w-1/2 action-btn bg-red-600 text-white uppercase text-sm';
            }
            // Reset class if waiting
            if (game.state === 'waiting') {
                btn.className = currentCurrency === 'stars' 
                    ? 'w-1/2 action-btn neon-btn uppercase text-sm tracking-wider' 
                    : 'w-1/2 action-btn ton-btn uppercase text-sm tracking-wider';
            }
        }

        // --- CASES LOGIC ---
        function openCaseView(id) {
            activeCase = casesData[id];
            document.getElementById('cases-list').classList.add('hidden');
            document.getElementById('case-roulette-view').classList.remove('hidden');
            
            document.getElementById('active-case-name').innerText = activeCase.name;
            document.getElementById('active-case-name').style.color = activeCase.color;
            
            const btn = document.getElementById('spinBtn');
            btn.innerText = `–ö–†–£–¢–ò–¢–¨ –ó–ê ${activeCase.price} ${activeCase.curr.toUpperCase()}`;
            btn.className = `w-full py-5 rounded-2xl font-black uppercase text-sm tracking-widest shadow-xl transition transform active:scale-95 ${activeCase.btnClass}`;
            
            initRoulette();
        }

        function closeCaseView() {
            document.getElementById('case-roulette-view').classList.add('hidden');
            document.getElementById('cases-list').classList.remove('hidden');
        }

        function initRoulette() {
            const track = document.getElementById('rouletteTrack');
            track.innerHTML = '';
            // –ó–∞–ø–æ–ª–Ω—è–µ–º –ª–µ–Ω—Ç—É —Å–ª—É—á–∞–π–Ω—ã–º–∏ –ø—Ä–∏–∑–∞–º–∏ –∏–∑ –º–∞—Å—Å–∏–≤–∞ –ø—Ä–∏–∑–æ–≤ –∫–µ–π—Å–∞
            for(let i=0; i<60; i++) {
                let prize = activeCase.prizes[Math.floor(Math.random() * activeCase.prizes.length)];
                let div = document.createElement('div');
                div.className = 'roulette-item';
                div.innerHTML = `<span class="text-2xl">${activeCase.curr==='ton'?'üíé':'‚≠ê'}</span><span class="text-xs font-bold mt-2 text-gray-400">${prize}</span>`;
                track.appendChild(div);
            }
            track.style.transition = 'none';
            track.style.transform = 'translateX(0)';
        }

        function spinRoulette() {
            if (balances[activeCase.curr] < activeCase.price) return alert('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤!');
            
            balances[activeCase.curr] -= activeCase.price;
            updateBalance();
            
            const btn = document.getElementById('spinBtn');
            btn.disabled = true;
            
            const track = document.getElementById('rouletteTrack');
            
            // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –≤—ã–∏–≥—Ä—ã—à (–ø–æ–¥–∫—Ä—É—Ç–∫–∞: —á–∞—â–µ –ø–∞–¥–∞—é—Ç –º–∞–ª–µ–Ω—å–∫–∏–µ –ø—Ä–∏–∑—ã)
            let winIndex = Math.random() < 0.7 ? 0 : (Math.random() < 0.9 ? 1 : 2); // 0, 1 –∏–ª–∏ 2 –∏–Ω–¥–µ–∫—Å –∏–∑ –º–∞—Å—Å–∏–≤–∞ –ø—Ä–∏–∑–æ–≤ (—Å–∞–º—ã–µ –¥–µ—à–µ–≤—ã–µ)
            if (winIndex >= activeCase.prizes.length) winIndex = 0;
            let winAmount = activeCase.prizes[winIndex];

            // –ò–Ω–∂–µ–∫—Ç–∏–º –≤—ã–∏–≥—Ä—ã—à –≤ –Ω—É–∂–Ω–æ–µ –º–µ—Å—Ç–æ –ª–µ–Ω—Ç—ã (–∏–Ω–¥–µ–∫—Å 45)
            let targetCardIdx = 45;
            let targetCard = track.children[targetCardIdx];
            targetCard.innerHTML = `<span class="text-3xl animate-bounce">${activeCase.curr==='ton'?'üíé':'‚≠ê'}</span><span class="text-sm font-black mt-2 text-white">${winAmount}</span>`;
            targetCard.style.borderColor = activeCase.color;
            targetCard.style.boxShadow = `0 0 15px ${activeCase.color}`;

            let cardWidth = 98; // 90px width + 8px margin
            let offset = (targetCardIdx * cardWidth) - (track.parentElement.offsetWidth / 2) + (cardWidth / 2);
            
            track.style.transition = 'transform 4s cubic-bezier(0.15, 0, 0, 1)';
            track.style.transform = `translateX(-${offset}px)`;

            setTimeout(() => {
                balances[activeCase.curr] += winAmount;
                updateBalance();
                alert(`–í—ã–∏–≥—Ä—ã—à: ${winAmount} ${activeCase.curr.toUpperCase()}`);
                btn.disabled = false;
                
                setTimeout(() => {
                    track.style.transition = 'none';
                    track.style.transform = 'translateX(0)';
                }, 1000);
            }, 4100);
        }

        // --- WALLET UI ---
        function openWallet() {
            document.getElementById('wallet-currency-name').innerText = currentCurrency;
            const m = document.getElementById('wallet-modal');
            m.classList.remove('hidden', 'pointer-events-none', 'opacity-0');
            document.getElementById('wallet-content').classList.remove('translate-y-full');
        }
        function closeWallet() {
            const m = document.getElementById('wallet-modal');
            document.getElementById('wallet-content').classList.add('translate-y-full');
            m.classList.add('opacity-0', 'pointer-events-none');
            setTimeout(() => m.classList.add('hidden'), 300);
        }
        function walletAction(dir) {
            let val = parseFloat(document.getElementById('wallet-input').value);
            if (!val || val <= 0) return;
            if (dir === 1) {
                balances[currentCurrency] += val;
                alert('–£—Å–ø–µ—à–Ω–æ!');
            } else {
                if(balances[currentCurrency] >= val) {
                    balances[currentCurrency] -= val;
                    alert('–ó–∞—è–≤–∫–∞ –Ω–∞ –≤—ã–≤–æ–¥ —Å–æ–∑–¥–∞–Ω–∞!');
                } else alert('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ!');
            }
            updateBalance(); closeWallet(); document.getElementById('wallet-input').value = '';
        }

        // --- NAV ---
        function nav(page) {
            document.querySelectorAll('.tab-content').forEach(el => el.classList.remove('active'));
            document.getElementById('page-' + page).classList.add('active');
            
            document.querySelectorAll('.nav-item').forEach(el => el.classList.remove('active'));
            document.getElementById('nav-' + page).classList.add('active');
        }

        // Init
        window.onload = () => {
            setCurrency('stars');
            runCrashCycle();
        };
    </script>
</body>
</html>
